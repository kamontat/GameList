<!doctype html>
<html lang="en">
<body>
<h1>Get the last one to win!</h1>
<span id="numSticks">| | | | | | | | | | | | | | | | | | | | | (21)</span><br>
<input id="pickNum"><button id="pickButton">Pick</button>
<button id="resetButton">Reset!</button>

<ul id="gameTranscript"></ul>
<script src="jquery.js"></script>
<script type="text/javascript">
    var check = 0;
    var gameSticks = {
        remainingSticks: 21,
        remove: function(n) {
            var sticks = "";
            this.remainingSticks -= n;
            for (var i = 0; i < this.remainingSticks; i++) {
                sticks += "| ";
            }
            sticks += "(" + this.remainingSticks + ")";
            $("#numSticks").text(sticks);
        },
        checkWin: function(user, opposite) {
            if (this.remainingSticks == 1) {
                winner(user);
            }
            if (this.remainingSticks < 1) {
                winner(opposite);
            }
        }
    };
    
    function autoPick() {
        if (gameSticks.remainingSticks == 4) {
            return 3;
        } else if (gameSticks.remainingSticks == 3) {
            return 2;
        } else if (gameSticks.remainingSticks == 2) {
            return 1;
        } else {
            return parseInt(Math.ceil(Math.random() * 3));
        }
    }
    
    function addToTranscript(msg) {
        $("#gameTranscript").append("<li>" + msg + "</li>");
    }
    
    function errorInput(user) {
        alert(user + " can't enter number more than current number (" + gameSticks.remainingSticks + ")");
    }
    
    function winner(user) {
        addToTranscript("!!!" + user + "  WINNER!!!");
        if (user == "YOU") {
            check = 1;
        } else {
            check = -1;
        }
    }
    
    function pickSticks() {
        var pick = $("#pickNum").val();
        if (check == 1) {
            winner("YOU");
        } else if (check == -1) {
            winner("COMPUTER");
        } else {
            if (pick <= 3) {

                if (pick <= gameSticks.remainingSticks) {
                    gameSticks.remove(pick);
                    addToTranscript( "You pick " + pick);
                }
                gameSticks.checkWin("YOU", "COMPUTER");
                if (check == 0) {
                    var computerNum = autoPick();
                    if (computerNum <= gameSticks.remainingSticks) {
                        gameSticks.remove(computerNum);
                        addToTranscript("Computer picks " + computerNum);
                    }
                    gameSticks.checkWin("COMPUTER", "YOU");
                }
            } else {
                alert("can't enter number more than 3");
            }
        }
    }
    function resetGame() {
        gameSticks.remainingSticks = 21
        $("#gameTranscript").text("");
        $("#numSticks").text("| | | | | | | | | | | | | | | | | | | | | (21)");
        check = 0;
    }
    $(function() {
        $("#pickButton").click(pickSticks);
        $("#resetButton").click(resetGame);
    });
</script>
</body>
</html>